"use strict";var _createClass=function(){function n(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,s){return t&&n(e.prototype,t),s&&n(e,s),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){var e=function(){function t(e){_classCallCheck(this,t);this.options=this.set_options({selection:".selection",selected_class_name:"selected",select_box_class_name:"select-box",update_selection:!1,on_select_start:function(){},on_select_change:function(){},on_select_end:function(){}},e),this.is_dragging=[],this.selection_items=[],this.start_x=0,this.start_y=0,this.select_box=document.createElement("div")}return _createClass(t,[{key:"set_options",value:function(e,t){var s=void 0,n={};for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s]);for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s]);return n}},{key:"attach",value:function(){this.build_select_box(),this.hide_select_box(),this.bind_events(),document.getElementsByTagName("body")[0].appendChild(this.select_box)}},{key:"build_select_box",value:function(){this.select_box.className=this.options.select_box_class_name,this.select_box.style.position="absolute",this.select_box.style.left="0",this.select_box.style.top="0",this.select_box.style.width="0",this.select_box.style.height="0"}},{key:"show_select_box",value:function(){this.select_box.style.display="block"}},{key:"hide_select_box",value:function(){this.select_box.style.display="none"}},{key:"bind_events",value:function(){document.addEventListener("selectstart",this.on_select_start.bind(this)),document.addEventListener("mousedown",this.on_mouse_down.bind(this))}},{key:"on_select_start",value:function(e){e.preventDefault()}},{key:"on_mouse_down",value:function(e){var t=this;this.is_dragging=!0,this.start_x=e.pageX,this.start_y=e.pageY,this.selection_items=this.build_items(document.querySelectorAll(this.options.selection)),this.build_select_box(),this.show_select_box(),this.options.on_select_start.call(null,this.get_selected_items()),document.addEventListener("mouseup",this.on_mouse_up.bind(this)),setTimeout(function(){if(!t.is_dragging)return!1;document.addEventListener("mousemove",t.on_mouse_move.bind(t))},100)}},{key:"on_mouse_up",value:function(e){this.options.on_select_end.call(null,this.selection_items),this.is_dragging=!1,this.selection_items=[],this.hide_select_box(),document.removeEventListener("mousemove",this.on_mouse_move.bind(this)),document.removeEventListener("mouseup",this.on_mouse_up.bind(this))}},{key:"on_mouse_move",value:function(e){var t=e.pageX,s=e.pageY,n=Math.min(this.start_y,s),i=Math.min(this.start_x,t),o=Math.abs(this.start_x-t),l=Math.abs(this.start_y-s);this.select_box.style.top=n+"px",this.select_box.style.left=i+"px",this.select_box.style.width=o+"px",this.select_box.style.height=l+"px",this.set_selected_items(n,i,o,l),this.options.on_select_change.call(null,this.get_selected_items())}},{key:"set_selected_items",value:function(s,n,i,o){var l=this;this.selection_items.forEach(function(e,t){l.is_element_selected(e.element,s,n,i,o)?e.is_selected?e.element.classList.remove(l.options.selected_class_name):e.element.classList.add(l.options.selected_class_name):e.is_selected?e.element.classList.add(l.options.selected_class_name):e.element.classList.remove(l.options.selected_class_name)})}},{key:"is_element_selected",value:function(e,t,s,n,i){return e.offsetLeft>=s&&e.offsetTop>=t&&e.offsetLeft+e.offsetWidth<=s+n&&e.offsetTop+e.offsetHeight<=t+i}},{key:"get_selected_items",value:function(){return Array.prototype.map.call(this.selection_items,function(e){return!!e.is_selected&&e.element}).filter(function(e){return e})}},{key:"build_items",value:function(e){var t=this;return Array.prototype.map.call(e,function(e){return t.options.update_selection||e.classList.remove(t.options.selected_class_name),{element:e,is_selected:e.classList.contains(t.options.selected_class_name)}})}}]),t}();window||(window={}),window.DragEnSelect||(window.DragEnSelect={}),window.DragEnSelect=e}();