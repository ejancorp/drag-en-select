"use strict";var _createClass=function(){function i(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,s){return t&&i(e.prototype,t),s&&i(e,s),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){var e=function(){function t(e){_classCallCheck(this,t);this.options=this.set_options({selection:".selection",selected_class_name:"selected",select_box_class_name:"select-box",update_selection:!1,on_select_start:function(){},on_select_change:function(){},on_select_end:function(){}},e),this.is_dragging=[],this.selection_items=[],this.start_x=0,this.start_y=0,this.select_box=document.createElement("div"),this.set_mouse_move=null}return _createClass(t,[{key:"set_options",value:function(e,t){var s=void 0,i={};for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&(i[s]=e[s]);for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&(i[s]=t[s]);return i}},{key:"attach",value:function(){this.build_select_box(),this.hide_select_box(),this.bind_events(),document.getElementsByTagName("body")[0].appendChild(this.select_box)}},{key:"build_select_box",value:function(){this.select_box.className=this.options.select_box_class_name,this.select_box.style.position="absolute",this.select_box.style.left="0",this.select_box.style.top="0",this.select_box.style.width="0",this.select_box.style.height="0"}},{key:"show_select_box",value:function(){this.select_box.style.display="block"}},{key:"hide_select_box",value:function(){this.select_box.style.display="none"}},{key:"bind_events",value:function(){document.addEventListener("selectstart",this.on_select_start.bind(this),!1),document.addEventListener("mousedown",this.on_mouse_down.bind(this),!1)}},{key:"on_select_start",value:function(e){e.preventDefault()}},{key:"on_mouse_down",value:function(e){var t=this;this.is_dragging=!0,this.start_x=e.pageX,this.start_y=e.pageY,this.selection_items=this.build_items(document.querySelectorAll(this.options.selection)),this.build_select_box(),this.show_select_box(),this.options.on_select_start.call(null,this.get_selected_items()),document.addEventListener("mouseup",this.on_mouse_up.bind(this),!1),this.set_mouse_move=setTimeout(function(){if(!t.is_dragging)return!1;document.addEventListener("mousemove",t.on_mouse_move.bind(t),!1)},100)}},{key:"on_mouse_up",value:function(e){document.removeEventListener("mousemove",this.on_mouse_move.bind(this),!1),document.removeEventListener("mouseup",this.on_mouse_up.bind(this),!1),this.options.on_select_end.call(null,this.get_selected_items()),this.is_dragging=!1,this.selection_items=[],this.hide_select_box()}},{key:"on_mouse_move",value:function(e){if(this.is_dragging){var t=e.pageX,s=e.pageY,i=Math.min(this.start_y,s),n=Math.min(this.start_x,t),o=Math.abs(this.start_x-t),l=Math.abs(this.start_y-s);this.select_box.style.top=i+"px",this.select_box.style.left=n+"px",this.select_box.style.width=o+"px",this.select_box.style.height=l+"px",this.set_selected_items(i,n,o,l),this.options.on_select_change.call(null,this.get_selected_items())}}},{key:"set_selected_items",value:function(s,i,n,o){var l=this;this.selection_items.forEach(function(e,t){if(l.is_element_selected(e.element,s,i,n,o))e.element.classList.add(l.options.selected_class_name),l.selection_items[t].is_selected=!0;else if(e.is_selected)return e.element.classList.add(l.options.selected_class_name),void(l.selection_items[t].is_selected=!0)})}},{key:"is_element_selected",value:function(e,t,s,i,n){return e.offsetLeft>=s&&e.offsetTop>=t&&e.offsetLeft+e.offsetWidth<=s+i&&e.offsetTop+e.offsetHeight<=t+n}},{key:"get_selected_items",value:function(){return Array.prototype.map.call(this.selection_items,function(e){return!!e.is_selected&&e.element}).filter(function(e){return e})}},{key:"build_items",value:function(e){var t=this;return Array.prototype.map.call(e,function(e){return t.options.update_selection||e.classList.remove(t.options.selected_class_name),{element:e,is_selected:e.classList.contains(t.options.selected_class_name)}})}}]),t}();window||(window={}),window.DragEnSelect||(window.DragEnSelect={}),window.DragEnSelect=e}();